{% extends '@LinkORBNebula/module/base.html.twig' %}

{% block form_open %}
<form name="{{ form.vars.name }}" method="post" action="{{ form.vars.action }}" id="{{ form.vars.id }}">
{% endblock %}

{% block form_close %}
{{ form_rest(form) }}
</form>
{% endblock %}

{% block context_header_actions %}
  {% if wikiPage.id %}
    <a href="{{ path('wiki_page_edit', {'wikiName': wikiPage.wiki.name, 'pageName': wikiPage.name}) }}" class="btn btn-sm btn-outline-primary">
      <i class="icon-lux-edit me-1"></i> Content
    </a>
  {% endif %}
{% endblock %}

{% block context_content %}
  {{ form_widget(form) }}
{% endblock %}

{% block context_footer_actions %}
  <div class="d-flex justify-content-between w-100">
    {# Save button must come before delete form in DOM to avoid nested form issues #}
    <div class="order-2">
      <button type="submit" class="btn btn-success">
        <i class="icon-lux-check me-1"></i> {{ button_label|default(wikiPage.id ? 'Save' : 'Create page') }}
      </button>
    </div>
    <div class="order-1">
      {% if wikiPage.id and is_granted('delete', wikiPage) %}
        <form action="{{ path('wiki_page_delete', {'wikiName': wikiPage.wiki.name, 'pageName': wikiPage.name}) }}"
              method="post"
              onsubmit="return confirm('Are you sure you want to delete this page?')"
              class="d-inline">
          <input type="hidden" name="token" value="{{ csrf_token('delete-item') }}">
          <button type="submit" class="btn btn-danger">
            <i class="icon-lux-trash me-1"></i> Delete
          </button>
        </form>
      {% endif %}
    </div>
  </div>
{% endblock %}
